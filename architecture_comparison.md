# MLP μ…λ ¥ κµ¬μ΅° λΉ„κµ λ¶„μ„

## ν„μ¬ κµ¬μ΅° (GlobalAvgPool)

```
LiDAR (1080,) β†’ CNN β†’ (64, 135) β†’ GlobalAvgPool β†’ (64,) β†’ MLP
```

**μ¥μ :**
- β… νλΌλ―Έν„° μ μ μ (λΉ λ¥Έ ν•™μµ)
- β… μ„μΉ λ¶λ³€μ„± (translation invariance)
- β… κ³Όμ ν•© μ„ν— λ‚®μ

**λ‹¨μ :**
- β κ³µκ°„ μ •λ³΄ μ™„μ „ μ†μ‹¤ (μ–΄λ λ°©ν–¥μ— λ²½μ΄ μλ”μ§€ λ¨λ¦„)
- β "μ „λ°© 1mμ— λ²½" vs "μΆμΈ΅ 5mμ— λ²½" κµ¬λ¶„ λ¶κ°€
- β λ³µμ΅ν• μ¥μ• λ¬Ό ν¨ν„΄ ν•™μµ μ–΄λ ¤μ›€

**νλΌλ―Έν„°:**
- CNN: ~10K
- MLP Actor: 64Γ—64 + 64Γ—64 + 64Γ—64 β‰ 12K
- **μ΄ν•©: ~22K**

---

## μµμ… A: Flatten (λ¨λ“  κ³µκ°„ μ •λ³΄ μ μ§€)

```
LiDAR (1080,) β†’ CNN β†’ (64, 135) β†’ Flatten β†’ (8640,) β†’ MLP
```

**μ¥μ :**
- β… κ³µκ°„ μ •λ³΄ 100% μ μ§€
- β… κ° μ„μΉλ³„ νΉμ§• λ¨λ‘ ν™μ©
- β… λ³µμ΅ν• ν¨ν„΄ ν•™μµ κ°€λ¥

**λ‹¨μ :**
- β νλΌλ―Έν„° ν­λ°: 8640 β†’ MLP
- β ν•™μµ λλ¦Ό, κ³Όμ ν•© μ„ν—
- β λ©”λ¨λ¦¬ μ‚¬μ©λ‰ μ¦κ°€

**νλΌλ―Έν„°:**
- CNN: ~10K
- MLP Actor: 8640Γ—64 + 64Γ—64 + 64Γ—64 β‰ **553K** π±
- **μ΄ν•©: ~563K (ν„μ¬μ 25λ°°!)**

---

## μµμ… B: 1D Conv μ¶”κ°€ μ••μ¶• (κ¶μ¥)

```
LiDAR (1080,) β†’ CNN β†’ (64, 135)
  β†’ Conv1D(64β†’128, k=3, s=3) β†’ (128, 45)
  β†’ Conv1D(128β†’256, k=3, s=3) β†’ (256, 15)
  β†’ Flatten β†’ (3840,) β†’ MLP
```

**μ¥μ :**
- β… κ³µκ°„ μ •λ³΄ λ¶€λ¶„ μ μ§€ (15κ° μ„μΉ)
- β… νλΌλ―Έν„° μ λ‹Ήν•¨
- β… κ³„μΈµμ  νΉμ§• ν•™μµ

**λ‹¨μ :**
- β οΈ CNN λ μ΄μ–΄ μ¶”κ°€ (λ³µμ΅λ„ μ¦κ°€)
- β οΈ ν•μ΄νΌνλΌλ―Έν„° νλ‹ ν•„μ”

**νλΌλ―Έν„°:**
- CNN: ~10K + ~50K = 60K
- MLP Actor: 3840Γ—64 β‰ 246K
- **μ΄ν•©: ~306K (ν„μ¬μ 14λ°°)**

---

## μµμ… C: AdaptiveAvgPool (μ¤‘κ°„ νƒ€ν‘)

```
LiDAR (1080,) β†’ CNN β†’ (64, 135)
  β†’ AdaptiveAvgPool1D(32) β†’ (64, 32)
  β†’ Flatten β†’ (2048,) β†’ MLP
```

**μ¥μ :**
- β… 32κ° μ„μΉ μ •λ³΄ μ μ§€ (μ λ‹Ήν• ν•΄μƒλ„)
- β… νλΌλ―Έν„° μ¦κ°€ μ λ‹Ήν•¨
- β… κµ¬ν„ κ°„λ‹¨ (ν• μ¤„λ§ μμ •)

**λ‹¨μ :**
- β οΈ μ—¬μ „ν μ •λ³΄ μ†μ‹¤ (135 β†’ 32)

**νλΌλ―Έν„°:**
- CNN: ~10K
- MLP Actor: 2048Γ—64 + 64Γ—64 β‰ 131K
- **μ΄ν•©: ~141K (ν„μ¬μ 6λ°°)**

---

## μµμ… D: Attention λ©”μ»¤λ‹μ¦

```
LiDAR (1080,) β†’ CNN β†’ (64, 135)
  β†’ Self-Attention β†’ μ¤‘μ” μ„μΉ κ°€μ¤‘μΉ
  β†’ Weighted Sum β†’ (64,) β†’ MLP
```

**μ¥μ :**
- β… μ¤‘μ”ν• μ„μΉλ§ μ§‘μ¤‘
- β… ν•΄μ„ κ°€λ¥μ„± (μ–΄λ μμ—­ μ£Όλ©ν•λ”μ§€)
- β… νλΌλ―Έν„° μ λ‹Ήν•¨

**λ‹¨μ :**
- β κµ¬ν„ λ³µμ΅λ„ λ†’μ
- β ν•™μµ λ¶μ•μ •ν•  μ μμ
- β οΈ Attention κ°€μ¤‘μΉ ν•™μµ ν•„μ”

**νλΌλ―Έν„°:**
- CNN: ~10K
- Attention: ~20K
- MLP Actor: 64Γ—64 β‰ 12K
- **μ΄ν•©: ~42K (ν„μ¬μ 2λ°°)**

---

## μ¶”μ² μμ„

### 1μ„: μµμ… C (AdaptiveAvgPool) β­β­β­β­β­
**μ΄μ :**
- κµ¬ν„ κ°€μ¥ κ°„λ‹¨ (ν• μ¤„λ§ μμ •)
- νλΌλ―Έν„° μ¦κ°€ μ λ‹Ήν•¨ (6λ°°)
- 32κ° μ„μΉ = μ•½ 8.4λ„λ§λ‹¤ νΉμ§• μ μ§€
- λ²½/μ¥μ• λ¬Ό μΈμ‹μ— μ¶©λ¶„ν• ν•΄μƒλ„

**μ ν•©ν• κ²½μ°:**
- λΉ λ¥Έ ν”„λ΅ν† νƒ€μ…
- ν•™μµ μ•μ •μ„± μ¤‘μ”
- λ¦¬μ†μ¤ μ ν•μ 

---

### 2μ„: μµμ… D (Attention) β­β­β­β­
**μ΄μ :**
- ν•΄μ„ κ°€λ¥μ„± μµκ³ 
- νλΌλ―Έν„° ν¨μ¨μ 
- μµμ‹  λ”¥λ¬λ‹ νΈλ λ“

**μ ν•©ν• κ²½μ°:**
- μ—°κµ¬ λ©μ 
- λ¨λΈ μ„¤λ… κ°€λ¥μ„± ν•„μ”
- λ³µμ΅ν• μ¥μ• λ¬Ό ν™κ²½

---

### 3μ„: μµμ… B (Conv μ••μ¶•) β­β­β­
**μ΄μ :**
- μ„±λ¥ μΆ‹μ„ κ°€λ¥μ„±
- κ³„μΈµμ  νΉμ§• ν•™μµ

**μ ν•©ν• κ²½μ°:**
- GPU μ„±λ¥ μ¶©λ¶„
- μµκ³  μ„±λ¥ μ¶”κµ¬
- ν•μ΄νΌνλΌλ―Έν„° νλ‹ μ—¬μ 

---

### λΉ„μ¶”μ²: μµμ… A (Flatten) β
**μ΄μ :**
- νλΌλ―Έν„° λ„λ¬΄ λ§μ (25λ°°)
- κ³Όμ ν•© μ„ν—
- ν•™μµ μ‹κ°„ μ¤λ κ±Έλ¦Ό

---

## μ‹¤ν— κ³„ν

### Phase 1: μµμ… C κµ¬ν„ λ° ν…μ¤νΈ
1. `cnn_policy.py`μ—μ„ GlobalAvgPool β†’ AdaptiveAvgPool(32) λ³€κ²½
2. features_dim: 64 β†’ 2048 λ³€κ²½
3. κΈ°μ΅΄ λ¨λΈκ³Ό μ„±λ¥ λΉ„κµ

### Phase 2: μ„±λ¥ ν‰κ°€ κΈ°μ¤€
- β… μ¶©λλ¥  κ°μ†
- β… λ©νƒ€μ„ κ°μ„ 
- β… λ²½ κ·Όμ² μ£Όν–‰ μ•μ •μ„±
- β… ν•™μµ μ†λ„ (steps/sec)

### Phase 3: ν•„μ”μ‹ μµμ… D (Attention) μ‹λ„
